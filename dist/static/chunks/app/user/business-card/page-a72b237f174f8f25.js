(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5754],{6483:function(e,s,t){Promise.resolve().then(t.bind(t,5870))},5870:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var n=t(3827),a=t(4090),r=t(8792),i=t(7907),l=t(2874),c=t.n(l),o=t(5561),d=t(6619),m=t(2220),h=t(2209),u=t(9079);function x(){let[e,s]=(0,a.useState)(null),[t,l]=(0,a.useState)(!0),[x,f]=(0,a.useState)(null),[p,b]=(0,a.useState)(""),g=(0,a.useRef)(null),j=(0,a.useRef)(null),v=(0,i.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{l(!0),f(null);try{let e=await fetch("/api/db-update/create-business-cards-table-direct");console.log("Table creation response:",await e.json())}catch(e){console.error("Error creating table:",e)}try{let e=await fetch("/api/db-update/add-branch-company-tel-columns");console.log("Add columns response:",await e.json())}catch(e){console.error("Error adding columns:",e)}try{let e=await fetch("/api/db-update/add-branch-address-columns");console.log("Add branch address columns response:",await e.json())}catch(e){console.error("Error adding branch address columns:",e)}await new Promise(e=>setTimeout(e,1e3));let e=await fetch("/api/business-cards");if(console.log("API response status:",e.status),!e.ok){let s=await e.json();throw console.error("API error:",s),Error(s.error||"Failed to fetch business card")}let t=await e.json();if(console.log("Business card data:",t),t.branch||(t.branch="สำนักงานใหญ่"),t.company_tel||(t.company_tel="02-461-6291"),t.branch_address_th||(t.branch_address_th="168 หมู่ 2 ตำบลคลองสวน"),t.branch_address_en||(t.branch_address_en="168 M.2 Baanklongsuan, Phrasamutjede, Samutprakarn 10290 Thailand"),s(t),t.id){let e=u.env.NEXT_PUBLIC_BASE_URL||"https://doc.nozomi-th.com";b("".concat(e,"/share/business-card/").concat(t.id))}}catch(e){console.error("Error loading business card:",e),f("Failed to load business card. Please try again.")}finally{l(!1)}})()},[]);let N=async()=>{if(j.current)try{let e=(await c()(j.current,{scale:2,backgroundColor:null,width:850,height:500,windowWidth:850,windowHeight:500})).toDataURL("image/png"),s=document.createElement("a");s.href=e,s.download="business-card.png",s.click()}catch(e){console.error("Error generating image:",e),alert("Failed to download business card image. Please try again.")}},w=async()=>{try{await fetch("/api/db-update/create-business-cards-table-direct"),v.refresh()}catch(e){console.error("Error retrying:",e)}},y=e=>["BEGIN:VCARD","VERSION:3.0","N:".concat(e.name_en),"FN:".concat(e.name_en),"ORG:".concat(e.company_en).concat(e.department_en?";".concat(e.department_en):""),"TITLE:".concat(e.position_en),"TEL;TYPE=CELL:".concat(e.tel),"TEL;TYPE=WORK:".concat(e.company_tel),e.fax?"TEL;TYPE=FAX:".concat(e.fax):"","EMAIL:".concat(e.email),e.website?"URL:".concat(e.website):"","ADR;TYPE=WORK:;;".concat("Nozomi Enterprise (Thailand) Co., Ltd.382 M.4, Baanklongsuan Rd., Phrasamutjedei,Samut Prakan, Thailand 10290"),e.line_id?"X-LINE:".concat(e.line_id):"",e.facebook?"X-FACEBOOK:".concat(e.facebook):"",e.name_th?"X-NAME-TH:".concat(e.name_th):"",e.position_th?"X-POSITION-TH:".concat(e.position_th):"",e.company_th?"X-COMPANY-TH:".concat(e.company_th):"","END:VCARD"].filter(e=>""!==e).join("\n"),_=e=>e.startsWith("+66")?"0"+e.substring(3).replace(/\s/g,"-"):e.replace(/\s/g,"-"),E=e=>e.replace("/",", ");return t?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):x?(0,n.jsxs)("div",{className:"text-center py-10",children:[(0,n.jsx)("p",{className:"text-red-500 mb-4",children:x}),(0,n.jsx)("button",{onClick:w,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Try Again"})]}):e?(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,n.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,n.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Your Business Card"}),(0,n.jsxs)(r.default,{href:"/user/business-card/edit",className:"flex items-center text-blue-500 hover:text-blue-700",children:[(0,n.jsx)("span",{className:"h-4 w-4 mr-1",children:"✏️"}),"Edit"]})]}),(0,n.jsx)("div",{className:"relative mx-auto flex justify-center",style:{width:"100%"},children:(0,n.jsxs)("div",{id:"business-card",ref:g,className:"bg-white rounded-lg shadow-lg overflow-hidden",style:{width:"380px",height:"240px",padding:"15px",boxSizing:"border-box",position:"relative",fontFamily:"Arial, sans-serif"},children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)("div",{className:"w-8 h- mr-2",children:(0,n.jsx)("img",{src:"/images/nozomi-logo.png",alt:"Nozomi Logo",className:"w-full h-full object-contain"})}),(0,n.jsx)("div",{className:"text-xs font-bold leading-tight",children:e.company_en})]}),(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("div",{className:"text-xs font-medium",children:e.name_th}),(0,n.jsx)("div",{className:"text-xs font-bold text-blue-900",children:e.name_en}),e.position_en&&(0,n.jsx)("div",{className:"text-xs italic",children:e.position_en})]}),(0,n.jsxs)("div",{className:"text-[10px] space-y-0.5",children:[(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"font-semibold mr-1",children:"Mobile :"}),(0,n.jsx)("span",{children:_(e.tel)})]}),(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"font-semibold mr-1",children:"E-mail :"}),(0,n.jsx)("span",{children:e.email})]})]}),(0,n.jsx)("div",{className:"absolute right-2 top-14",children:(0,n.jsx)("div",{className:"w-20 h-14",children:(0,n.jsx)("img",{src:"/images/urs-certification-new.png",alt:"URS Certification",className:"w-full h-full object-contain"})})}),(0,n.jsxs)("div",{className:"text-[10px] mt-1",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold",children:"Head Office : "}),(0,n.jsx)("span",{style:{whiteSpace:"pre-line"},children:E(e.address_en)})]}),(0,n.jsxs)("div",{children:["Tel : ",e.company_tel," Fax : ",e.fax]}),(0,n.jsxs)("div",{className:"mt-1",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Branch 1 : "}),(0,n.jsx)("span",{style:{whiteSpace:"pre-line"},children:E(e.branch_address_en)})]})]}),(0,n.jsxs)("div",{className:"absolute bottom-2 right-2 flex flex-col items-center",children:[(0,n.jsx)(h.ZP,{value:p,size:60,renderAs:"svg",includeMargin:!1}),(0,n.jsx)("div",{className:"text-[8px] text-green-600 font-semibold mt-0.5",children:"Scan to view"})]})]})})]}),(0,n.jsx)("div",{className:"w-full md:w-1/2",children:(0,n.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Actions"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,n.jsxs)("button",{onClick:N,className:"flex items-center justify-center p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[(0,n.jsx)(o.Z,{className:"h-5 w-5 mr-2"}),"Save image"]}),(0,n.jsxs)("button",{onClick:()=>{if(e)try{let s=y(e),t=new Blob([s],{type:"text/vcard;charset=utf-8"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="".concat(e.name_en.replace(/\s+/g,"_"),".vcf"),a.click(),URL.revokeObjectURL(n)}catch(e){console.error("Error generating vCard:",e),alert("Failed to download vCard. Please try again.")}},className:"flex items-center justify-center p-3 bg-green-500 text-white rounded-lg hover:bg-green-600",children:[(0,n.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Save vCard"]}),(0,n.jsxs)("button",{onClick:()=>{window.open("https://maps.app.goo.gl/Tf29bSF2sKxbS7NYA","_blank")},className:"flex items-center justify-center p-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600",children:[(0,n.jsx)(m.Z,{className:"h-5 w-5 mr-2"}),"Google Map"]})]}),(0,n.jsxs)("div",{className:"mt-8",children:[(0,n.jsx)("h3",{className:"font-semibold mb-2",children:"Business Card Information"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,n.jsx)("span",{className:"font-medium",children:"Size:"})," 95mm x 60mm"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium",children:"Format:"})," PNG image"]})]})]})}),(0,n.jsx)("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:(0,n.jsxs)("div",{id:"hidden-business-card",ref:j,className:"bg-white overflow-hidden",style:{width:"".concat(850,"px"),height:"".concat(500,"px"),padding:"30px",boxSizing:"border-box",position:"relative",fontFamily:"Arial, sans-serif"},children:[(0,n.jsxs)("div",{className:"flex items-center mb-4",children:[(0,n.jsx)("div",{className:"w-20 h-20 mr-4",children:(0,n.jsx)("img",{src:"/images/nozomi-logo.png",alt:"Nozomi Logo",className:"w-full h-full object-contain"})}),(0,n.jsx)("div",{className:"text-3xl font-bold leading-tight",children:e.company_en})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"text-xl font-medium",children:e.name_th}),(0,n.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.name_en}),e.position_en&&(0,n.jsx)("div",{className:"text-xl italic",children:e.position_en})]}),(0,n.jsxs)("div",{className:"text-lg space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"font-semibold mr-2",children:"Mobile :"}),(0,n.jsx)("span",{children:_(e.tel)})]}),(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"font-semibold mr-2",children:"E-mail :"}),(0,n.jsx)("span",{children:e.email})]})]}),(0,n.jsx)("div",{className:"absolute right-4 top-28",children:(0,n.jsx)("div",{className:"w-40 h-28",children:(0,n.jsx)("img",{src:"/images/urs-certification-new.png",alt:"URS Certification",className:"w-full h-full object-contain"})})}),(0,n.jsxs)("div",{className:"text-lg mt-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold",children:"Head Office : "}),(0,n.jsx)("span",{style:{whiteSpace:"pre-line"},children:E(e.address_en)})]}),(0,n.jsxs)("div",{children:["Tel : ",e.company_tel," Fax : ",e.fax]}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Branch 1 : "}),(0,n.jsx)("span",{style:{whiteSpace:"pre-line"},children:E(e.branch_address_en)})]})]}),(0,n.jsxs)("div",{className:"absolute bottom-4 right-4 flex flex-col items-center",children:[(0,n.jsx)(h.ZP,{value:p,size:120,renderAs:"svg",includeMargin:!1}),(0,n.jsx)("div",{className:"text-base text-green-600 font-semibold mt-1",children:"Scan to view"})]})]})})]}):(0,n.jsxs)("div",{className:"text-center py-10",children:[(0,n.jsx)("p",{className:"mb-4",children:"You don't have a business card yet."}),(0,n.jsx)(r.default,{href:"/user/business-card/edit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Create Business Card"})]})}},8792:function(e,s,t){"use strict";t.d(s,{default:function(){return a.a}});var n=t(5250),a=t.n(n)},9079:function(e,s,t){"use strict";var n,a;e.exports=(null==(n=t.g.process)?void 0:n.env)&&"object"==typeof(null==(a=t.g.process)?void 0:a.env)?t.g.process:t(3127)},3127:function(e){"use strict";!function(){var s={229:function(e){var s,t,n,a=e.exports={};function r(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(s===setTimeout)return setTimeout(e,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(e,0);try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(e){s=r}try{t="function"==typeof clearTimeout?clearTimeout:i}catch(e){t=i}}();var c=[],o=!1,d=-1;function m(){o&&n&&(o=!1,n.length?c=n.concat(c):d=-1,c.length&&h())}function h(){if(!o){var e=l(m);o=!0;for(var s=c.length;s;){for(n=c,c=[];++d<s;)n&&n[d].run();d=-1,s=c.length}n=null,o=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(s){try{return t.call(null,e)}catch(s){return t.call(this,e)}}}(e)}}function u(e,s){this.fun=e,this.array=s}function x(){}a.nextTick=function(e){var s=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)s[t-1]=arguments[t];c.push(new u(e,s)),1!==c.length||o||l(h)},u.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=x,a.addListener=x,a.once=x,a.off=x,a.removeListener=x,a.removeAllListeners=x,a.emit=x,a.prependListener=x,a.prependOnceListener=x,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},t={};function n(e){var a=t[e];if(void 0!==a)return a.exports;var r=t[e]={exports:{}},i=!0;try{s[e](r,r.exports,n),i=!1}finally{i&&delete t[e]}return r.exports}n.ab="//";var a=n(229);e.exports=a}()}},function(e){e.O(0,[7337,5250,9502,2971,8069,1744],function(){return e(e.s=6483)}),_N_E=e.O()}]);