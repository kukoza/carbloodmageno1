(()=>{var e={};e.id=5754,e.ids=[5754],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6955:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>o});var t=a(50482),n=a(69108),r=a(62563),i=a.n(r),l=a(68300),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(s,c);let o=["",{children:["user",{children:["business-card",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,56025)),"C:\\xampp\\htdocs\\car-booking-system-110\\car-booking-system-110\\app\\user\\business-card\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,12536)),"C:\\xampp\\htdocs\\car-booking-system-110\\car-booking-system-110\\app\\user\\business-card\\layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,8255)),"C:\\xampp\\htdocs\\car-booking-system-110\\car-booking-system-110\\app\\user\\business-card\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,66175)),"C:\\xampp\\htdocs\\car-booking-system-110\\car-booking-system-110\\app\\user\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,15438)),"C:\\xampp\\htdocs\\car-booking-system-110\\car-booking-system-110\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,69361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\xampp\\htdocs\\car-booking-system-110\\car-booking-system-110\\app\\user\\business-card\\page.tsx"],m="/user/business-card/page",x={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/user/business-card/page",pathname:"/user/business-card",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},32088:(e,s,a)=>{Promise.resolve().then(a.bind(a,50050))},50050:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>x});var t=a(95344),n=a(3729),r=a(56506),i=a(8428),l=a(9282),c=a(20016),o=a(93431),d=a(17280),m=a(44337);function x(){let[e,s]=(0,n.useState)(null),[a,x]=(0,n.useState)(!0),[h,u]=(0,n.useState)(null),[p,b]=(0,n.useState)(""),g=(0,n.useRef)(null),f=(0,n.useRef)(null),j=(0,i.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{x(!0),u(null);try{let e=await fetch("/api/db-update/create-business-cards-table-direct");console.log("Table creation response:",await e.json())}catch(e){console.error("Error creating table:",e)}try{let e=await fetch("/api/db-update/add-branch-company-tel-columns");console.log("Add columns response:",await e.json())}catch(e){console.error("Error adding columns:",e)}try{let e=await fetch("/api/db-update/add-branch-address-columns");console.log("Add branch address columns response:",await e.json())}catch(e){console.error("Error adding branch address columns:",e)}await new Promise(e=>setTimeout(e,1e3));let e=await fetch("/api/business-cards");if(console.log("API response status:",e.status),!e.ok){let s=await e.json();throw console.error("API error:",s),Error(s.error||"Failed to fetch business card")}let a=await e.json();if(console.log("Business card data:",a),a.branch||(a.branch="สำนักงานใหญ่"),a.company_tel||(a.company_tel="02-461-6291"),a.branch_address_th||(a.branch_address_th="168 หมู่ 2 ตำบลคลองสวน"),a.branch_address_en||(a.branch_address_en="168 M.2 Baanklongsuan, Phrasamutjede, Samutprakarn 10290 Thailand"),s(a),a.id){let e=process.env.NEXT_PUBLIC_BASE_URL||"https://doc.nozomi-th.com";b(`${e}/share/business-card/${a.id}`)}}catch(e){console.error("Error loading business card:",e),u("Failed to load business card. Please try again.")}finally{x(!1)}})()},[]);let v=async()=>{if(f.current)try{let e=(await (0,l.Z)(f.current,{scale:2,backgroundColor:null,width:850,height:500,windowWidth:850,windowHeight:500})).toDataURL("image/png"),s=document.createElement("a");s.href=e,s.download="business-card.png",s.click()}catch(e){console.error("Error generating image:",e),alert("Failed to download business card image. Please try again.")}},N=async()=>{try{await fetch("/api/db-update/create-business-cards-table-direct"),j.refresh()}catch(e){console.error("Error retrying:",e)}},y=e=>["BEGIN:VCARD","VERSION:3.0",`N:${e.name_en}`,`FN:${e.name_en}`,`ORG:${e.company_en}${e.department_en?`;${e.department_en}`:""}`,`TITLE:${e.position_en}`,`TEL;TYPE=CELL:${e.tel}`,`TEL;TYPE=WORK:${e.company_tel}`,e.fax?`TEL;TYPE=FAX:${e.fax}`:"",`EMAIL:${e.email}`,e.website?`URL:${e.website}`:"","ADR;TYPE=WORK:;;Nozomi Enterprise (Thailand) Co., Ltd.382 M.4, Baanklongsuan Rd., Phrasamutjedei,Samut Prakan, Thailand 10290",e.line_id?`X-LINE:${e.line_id}`:"",e.facebook?`X-FACEBOOK:${e.facebook}`:"",e.name_th?`X-NAME-TH:${e.name_th}`:"",e.position_th?`X-POSITION-TH:${e.position_th}`:"",e.company_th?`X-COMPANY-TH:${e.company_th}`:"","END:VCARD"].filter(e=>""!==e).join("\n"),w=e=>e.startsWith("+66")?"0"+e.substring(3).replace(/\s/g,"-"):e.replace(/\s/g,"-"),_=e=>e.replace("/",", ");return a?t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):h?(0,t.jsxs)("div",{className:"text-center py-10",children:[t.jsx("p",{className:"text-red-500 mb-4",children:h}),t.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Try Again"})]}):e?(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,t.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,t.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Your Business Card"}),(0,t.jsxs)(r.default,{href:"/user/business-card/edit",className:"flex items-center text-blue-500 hover:text-blue-700",children:[t.jsx("span",{className:"h-4 w-4 mr-1",children:"✏️"}),"Edit"]})]}),t.jsx("div",{className:"relative mx-auto flex justify-center",style:{width:"100%"},children:(0,t.jsxs)("div",{id:"business-card",ref:g,className:"bg-white rounded-lg shadow-lg overflow-hidden",style:{width:"380px",height:"240px",padding:"15px",boxSizing:"border-box",position:"relative",fontFamily:"Arial, sans-serif"},children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[t.jsx("div",{className:"w-8 h- mr-2",children:t.jsx("img",{src:"/images/nozomi-logo.png",alt:"Nozomi Logo",className:"w-full h-full object-contain"})}),t.jsx("div",{className:"text-xs font-bold leading-tight",children:e.company_en})]}),(0,t.jsxs)("div",{className:"mb-2",children:[t.jsx("div",{className:"text-xs font-medium",children:e.name_th}),t.jsx("div",{className:"text-xs font-bold text-blue-900",children:e.name_en}),e.position_en&&t.jsx("div",{className:"text-xs italic",children:e.position_en})]}),(0,t.jsxs)("div",{className:"text-[10px] space-y-0.5",children:[(0,t.jsxs)("div",{className:"flex items-start",children:[t.jsx("span",{className:"font-semibold mr-1",children:"Mobile :"}),t.jsx("span",{children:w(e.tel)})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[t.jsx("span",{className:"font-semibold mr-1",children:"E-mail :"}),t.jsx("span",{children:e.email})]})]}),t.jsx("div",{className:"absolute right-2 top-14",children:t.jsx("div",{className:"w-20 h-14",children:t.jsx("img",{src:"/images/urs-certification-new.png",alt:"URS Certification",className:"w-full h-full object-contain"})})}),(0,t.jsxs)("div",{className:"text-[10px] mt-1",children:[(0,t.jsxs)("div",{children:[t.jsx("span",{className:"font-semibold",children:"Head Office : "}),t.jsx("span",{style:{whiteSpace:"pre-line"},children:_(e.address_en)})]}),(0,t.jsxs)("div",{children:["Tel : ",e.company_tel," Fax : ",e.fax]}),(0,t.jsxs)("div",{className:"mt-1",children:[t.jsx("span",{className:"font-semibold",children:"Branch 1 : "}),t.jsx("span",{style:{whiteSpace:"pre-line"},children:_(e.branch_address_en)})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-2 right-2 flex flex-col items-center",children:[t.jsx(m.ZP,{value:p,size:60,renderAs:"svg",includeMargin:!1}),t.jsx("div",{className:"text-[8px] text-green-600 font-semibold mt-0.5",children:"Scan to view"})]})]})})]}),t.jsx("div",{className:"w-full md:w-1/2",children:(0,t.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Actions"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("button",{onClick:v,className:"flex items-center justify-center p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[t.jsx(c.Z,{className:"h-5 w-5 mr-2"}),"Save image"]}),(0,t.jsxs)("button",{onClick:()=>{if(e)try{let s=y(e),a=new Blob([s],{type:"text/vcard;charset=utf-8"}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download=`${e.name_en.replace(/\s+/g,"_")}.vcf`,n.click(),URL.revokeObjectURL(t)}catch(e){console.error("Error generating vCard:",e),alert("Failed to download vCard. Please try again.")}},className:"flex items-center justify-center p-3 bg-green-500 text-white rounded-lg hover:bg-green-600",children:[t.jsx(o.Z,{className:"h-5 w-5 mr-2"}),"Save vCard"]}),(0,t.jsxs)("button",{onClick:()=>{window.open("https://maps.app.goo.gl/Tf29bSF2sKxbS7NYA","_blank")},className:"flex items-center justify-center p-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600",children:[t.jsx(d.Z,{className:"h-5 w-5 mr-2"}),"Google Map"]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Business Card Information"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[t.jsx("span",{className:"font-medium",children:"Size:"})," 95mm x 60mm"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[t.jsx("span",{className:"font-medium",children:"Format:"})," PNG image"]})]})]})}),t.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:(0,t.jsxs)("div",{id:"hidden-business-card",ref:f,className:"bg-white overflow-hidden",style:{width:"850px",height:"500px",padding:"30px",boxSizing:"border-box",position:"relative",fontFamily:"Arial, sans-serif"},children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:"w-20 h-20 mr-4",children:t.jsx("img",{src:"/images/nozomi-logo.png",alt:"Nozomi Logo",className:"w-full h-full object-contain"})}),t.jsx("div",{className:"text-3xl font-bold leading-tight",children:e.company_en})]}),(0,t.jsxs)("div",{className:"mb-4",children:[t.jsx("div",{className:"text-xl font-medium",children:e.name_th}),t.jsx("div",{className:"text-2xl font-bold text-blue-900",children:e.name_en}),e.position_en&&t.jsx("div",{className:"text-xl italic",children:e.position_en})]}),(0,t.jsxs)("div",{className:"text-lg space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-start",children:[t.jsx("span",{className:"font-semibold mr-2",children:"Mobile :"}),t.jsx("span",{children:w(e.tel)})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[t.jsx("span",{className:"font-semibold mr-2",children:"E-mail :"}),t.jsx("span",{children:e.email})]})]}),t.jsx("div",{className:"absolute right-4 top-28",children:t.jsx("div",{className:"w-40 h-28",children:t.jsx("img",{src:"/images/urs-certification-new.png",alt:"URS Certification",className:"w-full h-full object-contain"})})}),(0,t.jsxs)("div",{className:"text-lg mt-4",children:[(0,t.jsxs)("div",{children:[t.jsx("span",{className:"font-semibold",children:"Head Office : "}),t.jsx("span",{style:{whiteSpace:"pre-line"},children:_(e.address_en)})]}),(0,t.jsxs)("div",{children:["Tel : ",e.company_tel," Fax : ",e.fax]}),(0,t.jsxs)("div",{className:"mt-2",children:[t.jsx("span",{className:"font-semibold",children:"Branch 1 : "}),t.jsx("span",{style:{whiteSpace:"pre-line"},children:_(e.branch_address_en)})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-4 right-4 flex flex-col items-center",children:[t.jsx(m.ZP,{value:p,size:120,renderAs:"svg",includeMargin:!1}),t.jsx("div",{className:"text-base text-green-600 font-semibold mt-1",children:"Scan to view"})]})]})})]}):(0,t.jsxs)("div",{className:"text-center py-10",children:[t.jsx("p",{className:"mb-4",children:"You don't have a business card yet."}),t.jsx(r.default,{href:"/user/business-card/edit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Create Business Card"})]})}},56506:(e,s,a)=>{"use strict";a.d(s,{default:()=>n.a});var t=a(61476),n=a.n(t)},56025:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>r,__esModule:()=>n,default:()=>i});let t=(0,a(86843).createProxy)(String.raw`C:\xampp\htdocs\car-booking-system-110\car-booking-system-110\app\user\business-card\page.tsx`),{__esModule:n,$$typeof:r}=t,i=t.default}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[1638,1227,1476,4345,796,138],()=>a(6955));module.exports=t})();